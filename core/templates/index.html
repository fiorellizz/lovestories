{% load static %}
<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{{ cliente.nome_casal }}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Montserrat:wght@300;400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{% static 'core/css/style.css' %}">
    {% for item in cliente.imagens.all %}
    {% if item.tipo == 'hero' %}
    <style>
        .hero-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)),
            url('{{ item.imagem.imagem.url }}');
            background-size: cover;
            background-position: center;
            z-index: -1;
        }
    </style>
    {% endif %}
    {% endfor %}

    <link rel="shortcut icon" href="{% static 'core/img/favicon.png' %}" type="image/x-icon">
</head>

<body>
    <div class="preloader">
        <div class="heart"></div>
    </div>

    <section class="hero">
        <div class="hero-bg"></div>
        <div class="hero-content">
            <h1>{{ cliente.hero_title }}</h1>
            <p>{{ cliente.hero_subtitle }}</p>
            <div class="hero-date">{{ cliente.data_inicio }} - {{ data_de_hoje }}</div>
        </div>
    </section>

    {% if cliente.plano == 'PREMIUM' %}
    <section class="counter">
        <div class="container">
            <h2>Nosso Tempo Juntos</h2>
            <p>Cada segundo ao seu lado √© precioso</p>

            <div class="counter-container">
                <div class="counter-item">
                    <div class="counter-value" id="months">0</div>
                    <div class="counter-label">Meses</div>
                </div>
                <div class="counter-item">
                    <div class="counter-value" id="days">0</div>
                    <div class="counter-label">Dias</div>
                </div>
                <div class="counter-item">
                    <div class="counter-value" id="hours">0</div>
                    <div class="counter-label">Horas</div>
                </div>
                <div class="counter-item">
                    <div class="counter-value" id="minutes">0</div>
                    <div class="counter-label">Minutos</div>
                </div>
            </div>
        </div>
    </section>
    {% endif %}

    <section class="letter">
        <div class="container">
            <h2>Carta de Amor</h2>
            <p>Palavras do meu cora√ß√£o para voc√™</p>

            <div class="letter-container">
                <div class="letter-paper">
                    {% for paragrafo in paragrafos %}
                    <p>{{ paragrafo }}</p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </section>

    <section class="gallery">
        <div class="container">
            <h2>Nossa Hist√≥ria em Fotos</h2>
            <p>Cada foto conta um peda√ßo da nossa hist√≥ria, cada sorriso guarda um momento especial.</p>

            <div class="gallery-container">
                {% for item in imagens_history %}
                <div class="gallery-item">
                    <img src="{{ item.imagem.imagem.url }}" alt="Nossa hist√≥ria {{ forloop.counter }}" loading="lazy">
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

    {% if cliente.plano == 'PREMIUM' %}
    <section class="music-player">
        <div class="container">
            <h2>Nossas M√∫sicas</h2>
            <p>A trilha sonora do nosso amor</p>

            <div class="player-container">
                {% for item in imagem_music %}
                <div class="album-cover">
                    <img src="{{ item.imagem.imagem.url }}" alt="Capa do √°lbum" id="album-cover">
                </div>
                {% endfor %}

                <div class="track-info">
                    <div class="track-title" id="track-title"></div>
                    <div class="track-artist" id="track-artist"></div>
                </div>

                <div class="player-controls">
                    <div class="control-btn" id="prev-btn">
                        <i class="fas fa-step-backward"></i>
                    </div>
                    <div class="control-btn play-btn" id="play-btn">
                        <i class="fas fa-play"></i>
                    </div>
                    <div class="control-btn" id="next-btn">
                        <i class="fas fa-step-forward"></i>
                    </div>
                </div>

                <div class="playlist">
                    {% for musica in musicas %}
                    <div class="playlist-item {% if forloop.first %}active{% endif %}"
                        data-src="{{ musica.arquivo_audio.url }}" data-title="{{ musica.titulo }}"
                        data-artist="{{ musica.autor.nome }}">
                        <div class="playlist-item-number">{{ forloop.counter }}</div>
                        <div class="playlist-item-info">
                            <div class="playlist-item-title">{{ musica.titulo }}</div>
                            <div class="playlist-item-artist">{{ musica.autor.nome }}</div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </section>
    {% endif %}

    <section class="moments">
        <div class="container">
            <h2>Momentos Especiais</h2>
            <p>Pequenos instantes que constroem nossa hist√≥ria</p>

            <div class="moments-container">
                <div class="moment-item">
                    <div class="moment-image">
                        <img src="{{ imagens_moment.0.imagem.imagem.url }}" alt="Primeiro encontro">
                    </div>
                    <div class="moment-text">
                        <h3>Nosso In√≠cio</h3>
                        <p>Desde o primeiro momento, soube que seria especial. Seu sorriso iluminou meu dia e meu
                            cora√ß√£o soube que tinha encontrado algu√©m especial.</p>
                    </div>
                </div>

                <div class="moment-item">
                    <div class="moment-image">
                        <img src="{{ imagens_moment.1.imagem.imagem.url }}" alt="Momentos juntos">
                    </div>
                    <div class="moment-text">
                        <h3>Nossos Sorrisos</h3>
                        <p>Cada risada compartilhada √© um tesouro guardado no cora√ß√£o. Com voc√™, at√© os momentos mais
                            simples se tornam inesquec√≠veis.</p>
                    </div>
                </div>

                <div class="moment-item">
                    <div class="moment-image">
                        <img src="{{ imagens_moment.2.imagem.imagem.url }}" alt="Momentos especiais">
                    </div>
                    <div class="moment-text">
                        <h3>Nossos Momentos</h3>
                        <p>Cada instante ao seu lado √© uma nova aventura. Obrigado por tornar meus dias mais coloridos e
                            cheios de vida.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-content">
            <h3>{{ cliente.footer_title }}</h3>
            <p>{{ cliente.footer_subtitle }}</p>
            <div class="heart-icon">‚ù§Ô∏è</div>
            <div class="qr-link" style="margin-top: 1rem;">
                <a href="{% url 'qr_page' slug=cliente.slug %}" target="_blank" class="qr-btn">
                    üì≤ Clique aqui para gerar seu QR Code
                </a>
            </div>
        </div>
    </footer>

    <div class="floating-hearts"></div>

    <script src="{% static 'core/js/script.js' %}"></script>

    <script>

        // Inicializar contador
        updateCountdown();

        // Fun√ß√£o para atualizar o contador
        function updateCountdown() {
            const startDate = new Date('{{ cliente.data_inicio|date:"Y-m-d" }}');
            const currentDate = new Date();

            // Diferen√ßa total em milissegundos
            const timeDiff = currentDate - startDate;

            // Calcular meses
            let months = (currentDate.getFullYear() - startDate.getFullYear()) * 12;
            months += currentDate.getMonth() - startDate.getMonth();

            // Ajustar meses se o dia atual for menor que o dia de in√≠cio
            if (currentDate.getDate() < startDate.getDate()) {
                months--;
            }

            // Calcular dias restantes
            const tempDate = new Date(startDate);
            tempDate.setMonth(startDate.getMonth() + months);
            const daysDiff = Math.max(0, Math.floor((currentDate - tempDate) / (1000 * 60 * 60 * 24)));

            // Calcular horas e minutos restantes (desde o in√≠cio do dia atual)
            const hours = currentDate.getHours();
            const minutes = currentDate.getMinutes();

            document.getElementById('months').textContent = months;
            document.getElementById('days').textContent = daysDiff;
            document.getElementById('hours').textContent = hours;
            document.getElementById('minutes').textContent = minutes;

            setTimeout(updateCountdown, 60000);
        }
    </script>
</body>

</html>